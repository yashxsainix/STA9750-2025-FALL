<!-- ui-widgets.html --------------------------------------------------- -->
<!-- USER INFO (top-left) -->
<div id="user-info">
  <div>Current time: <strong>November 10, 2025 09:56 PM EST</strong></div>
  <div>Country: <strong>US</strong></div>
</div>

<!-- LIVE STATS (below user info) -->
<div id="live-stats">
  <span id="clock"></span> | 
  <span id="co2-saved">0</span> kg CO₂ absorbed today
</div>

<!-- DARK MODE TOGGLE (top-left, below live-stats) -->
<button id="dark-toggle" title="Toggle Dark Mode">Dark Mode</button>

<style>
/* ---- USER INFO (top-left) ---- */
#user-info {
  position: fixed;
  top: 12px; left: 20px;
  font-size: 0.78rem; color: #555; line-height: 1.3;
  z-index: 998;
}
#user-info strong { color: #14532d; }

/* ---- LIVE STATS (below user info) ---- */
#live-stats {
  position: fixed;
  top: 52px; left: 20px;
  background: rgba(20,83,45,.94);
  color: #fff; padding: 8px 14px;
  border-radius: 8px; font: 0.85rem/1.4 monospace;
  box-shadow: 0 2px 8px rgba(0,0,0,.15);
  backdrop-filter: blur(4px); z-index: 998;
}

/* ---- DARK-MODE TOGGLE (below live-stats, same left) ---- */
#dark-toggle {
  position: fixed;
  top: 96px; left: 20px;   /* 52 + 44 (height of live-stats) */
  background: #14532d; color: #fff;
  border: none; padding: 8px 14px;
  border-radius: 8px; font-size: 0.9rem;
  cursor: pointer; z-index: 999;
  box-shadow: 0 2px 8px rgba(0,0,0,.15);
}

/* ---- DARK MODE STYLES ---- */
body.dark-mode { background:#121212; color:#e0e0e0; }
body.dark-mode h1,body.dark-mode h2,body.dark-mode h3 { color:#ecfdf5 !important; }
body.dark-mode .badge-soft { background:#0a2a17; color:#ecfdf5; }
body.dark-mode .leaflet-container { filter:invert(1) hue-rotate(180deg); }
body.dark-mode .js-plotly-plot   { filter:invert(1) hue-rotate(180deg); }
body.dark-mode #user-info { color:#aaa; }
body.dark-mode #live-stats { background:rgba(10,42,23,.94); }
body.dark-mode #dark-toggle { background:#0a2a17; }
</style>

<script>
// ---- 1. LIVE NYC CLOCK (updates every second) ----
function updateClock() {
  const est = new Date().toLocaleString("en-US", { timeZone: "America/New_York" });
  document.getElementById("clock").textContent =
    new Date(est).toLocaleTimeString([], { hour:'2-digit', minute:'2-digit', second:'2-digit' });
}
setInterval(updateClock, 1000);
updateClock();

// ---- 2. CO₂ COUNTER (592,000 trees × 0.022 kg/day) ----
const TREES = 592000;
const KG_PER_TREE_DAY = 0.022;
const MS_PER_DAY = 86400000;

// Start from today 00:00 EST
const todayStart = new Date();
todayStart.setHours(0, 0, 0, 0);
todayStart.setTime(todayStart.getTime() - 5*3600000); // EST offset

function updateCO2() {
  const elapsed = Date.now() - todayStart.getTime();
  const fraction = elapsed / MS_PER_DAY;
  const kg = TREES * KG_PER_TREE_DAY * fraction;
  document.getElementById("co2-saved").textContent = Math.floor(kg).toLocaleString();
}
setInterval(updateCO2, 10000);
updateCO2();

// ---- 3. DARK MODE TOGGLE ----
document.getElementById("dark-toggle").addEventListener("click", () => {
  document.body.classList.toggle("dark-mode");
  const isDark = document.body.classList.contains("dark-mode");
  document.getElementById("dark-toggle").textContent = isDark ? "Light Mode" : "Dark Mode";
});
</script>
